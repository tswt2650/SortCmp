#include <bits/stdc++.h>
#include <fstream>
#include <time.h>
using namespace std;

const int mmm = 1e6+5;
long long a[mmm], b[mmm];
int n = 1e6;

void quicksort(int l, int r);
void heapsort(int n);
void mergesort(int l, int r) ;

void nhap(char x[])
{
    char s[15] = "test";
    strcat(s,x);
    strcat(s,".txt");
    ifstream input (s);
    for (int i = 0; i < n; i++) input >> a[i];
    input.close();
}
ofstream output ("result.txt");
void tgtt(char x[])
{
    clock_t bd, kt;
    double time_use;
    switch (x[0])
    {
        case 'Q':
            {
                bd = clock();
                quicksort(0, n - 1);
                kt = clock();
                break;
            }
        case 'H':
            {
                bd = clock();
                heapsort(n);
                kt = clock();
                break;
            }
        case 'M':
            {
                bd = clock();
                mergesort(0, n - 1);
                kt = clock();
                break;
            }
        default:
            {
                bd = clock();
                sort(a, a + n);
                kt = clock();
                break;
            }
    }
    time_use = (double)(kt - bd) / CLOCKS_PER_SEC;
    output << "\t\t" << fixed << setprecision(3) << time_use << "s";
}

int main()
{
    char z[5], a1[20] = "HeapSort", a2[20] = "MergeSort",a3[20] = "SortCpp",a4[20] = "Quicksort";
    output << "test\t\tHeapSort\t\tMergeSort\t\tSortInCppLib\tQuickSort";
    for (int i = 1; i<=10; i++)
    {
        itoa(i,z,10);
        output << endl << i;

        nhap(z);
        tgtt(a1);

        nhap(z);
        tgtt(a2);

        nhap(z);
        tgtt(a3);

        nhap(z);
        tgtt(a4);
    }
    output.close();
	return 0;
}

void quicksort(int l,int r)
{
    if (l==r) return;
    else
    {
        long long x = a[(l+r)/2];
        int i = l, j = r;
        while(i<=j)
        {
            while(a[i] < x) ++i;
            while(a[j] > x) --j;
            if (i<=j)
            {
                swap(a[i], a[j]);
                ++i; --j;
            }
        }
        if (l < j) quicksort(l, j);
        if (r > i) quicksort(i, r);
    }
}

int s;
void upper(int i)
{
    if(i == 1) return;
    if (b[i] < b[i/2])
    {
        swap(b[i], b[i/2]);
        upper(i/2);
    }
}
void lower(int i)
{
    int x = i;
    if (i*2 <= s && b[x] > b[i*2]) x = 2*i;
    if (i*2 + 1 <= s && b[x] > b[i*2 + 1]) x = i*2 + 1;
    if (x != i)
    {
        swap(b[x], b[i]);
        lower(x);
    }
}
void push(int g)
{
    b[++s] = g;
    upper(s);
}
void pop()
{
    b[1] = b[s--];
    lower(1);
}
void heapsort(int n)
{
    for(int i = 0; i < n; i++) push(a[i]);
    for(int i = 0; i < n; i++)
    {
        a[i] = b[1];
        pop();
    }
}

void mergesort(int l,int r)
{
    if (l==r) return;
    else
    {
        int x = (l+r)/2;
        mergesort(l, x);
        mergesort(x + 1, r);
        for(int i = l; i < r+1; i++) b[i] = a[i];
        merge(b + l, b + x + 1, b + x + 1, b + r + 1, a + l);
    }
}
